import{createDefu as $}from"defu";import{installPackage as k}from"@antfu/install-pkg";import{createRequire as v}from"module";var w=process.env.NODE_ENV||"development",x=v(import.meta.url);function y(e){try{return x.resolve(e),!0}catch{return!1}}async function P(e,p){if(y(e))return!0;if(p&&w==="development")try{return await k(e,{silent:!0}),!0}catch{return!1}return!1}function b(e,p,l){let t="",r=l?"img":"svg";Object.entries(p).forEach(([a,n])=>{l?t+=`${a}:${n};`:t+=`${a}=${n} `});let s=`<${r}`;return s+=l?` style="${t}" src="data:image/svg+xml;utf8,${j(e)}">`:` ${t}> ${e}`,s+=`</${r}>`,s}async function h(e,p,l){let t=[];e.replace(p,(s,...a)=>{let n=l(s,...a);t.push(n)});let r=await Promise.all(t);return e.replace(p,()=>r.shift())}function j(e){return e.replace("<svg",~e.indexOf("xmlns")?"<svg":'<svg xmlns="http://www.w3.org/2000/svg"').replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/{/g,"%7B").replace(/}/g,"%7D").replace(/</g,"%3C").replace(/>/g,"%3E")}function q(e){e=$((t,r,s)=>{if(t[r]instanceof Map)return!0})(e,{installPkg:!0,alias:new Map,prefix:"",separator:":"});let l={async getIcons(t,r,s){e.alias.has(t)&&(t=e.alias.get(t)),e.prefix!==""&&!t.startsWith(e.prefix+e.separator)&&(t=e.prefix+e.separator+t);let[a,n]=t.split(e.separator),u="@iconify/json/json/"+a,c="@iconify-json/"+a,o="",i="";if(y(u)?o=u:await P(c,e.installPkg)&&(o=c),o.length>0){let{icons:f}=x(o);for(let g of Object.keys(f))g==n&&(i=f[g].body||"")}return i===""?i:b(i,r,s)},getIconsSync(t,r,s){e.alias.has(t)&&(t=e.alias.get(t)),e.prefix!==""&&!t.startsWith(e.prefix+e.separator)&&(t=e.prefix+e.separator+t);let[a,n]=t.split(e.separator),u="@iconify/json/json/"+a,c="@iconify-json/"+a,o="",i="";if(y(u)?o=u:y(c)&&(o=c),o.length>0){let{icons:f}=x(o);for(let g of Object.keys(f))g==n&&(i=f[g].body||"")}return i===""?i:b(i,r,s)},async iconify(t,r,s=/::(.*?)::/g){return await h(t,s,async(n,u)=>{let c=await l.getIcons(u,r.styles,r.base64);return c===""?n:c})}};return l}export{q as default};
